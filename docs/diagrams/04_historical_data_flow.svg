<svg xmlns="http://www.w3.org/2000/svg" width="1600" height="900" viewBox="0 0 1600 900"><defs><marker id='arrow' markerWidth='10' markerHeight='10' refX='9' refY='3' orient='auto' markerUnits='strokeWidth'><path d='M0,0 L10,3 L0,6 z' fill='#444'/></marker><style>text{font-family:Segoe UI,Arial,sans-serif; fill:#222; font-size:14px;}.title{font-size:26px; font-weight:700;}.edge{stroke:#444; stroke-width:2; fill:none; marker-end:url(#arrow);}.edgeLabel{font-size:12px; fill:#333;}.node{stroke:#2f2f2f; stroke-width:1.2; rx:10; ry:10;}.nodeLabel{font-size:13px; font-weight:600;}</style></defs><rect x='0' y='0' width='100%' height='100%' fill='#ffffff'/><text class='title' x='30' y='48'>Historical Data Flow</text><line class='edge' x1='240.0' y1='262.0' x2='620.0' y2='262.0'/><text class='edgeLabel' x='430.0' y='256.0' text-anchor='middle'>RequestBars</text><line class='edge' x1='620.0' y1='262.0' x2='1015.0' y2='262.0'/><text class='edgeLabel' x='817.5' y='256.0' text-anchor='middle'>token/exchange/interval</text><line class='edge' x1='1015.0' y1='262.0' x2='620.0' y2='262.0'/><text class='edgeLabel' x='817.5' y='256.0' text-anchor='middle'>candles dataframe</text><line class='edge' x1='620.0' y1='262.0' x2='1015.0' y2='452.0'/><line class='edge' x1='1015.0' y1='452.0' x2='1380.0' y2='452.0'/><line class='edge' x1='1380.0' y1='452.0' x2='240.0' y2='262.0'/><text class='edgeLabel' x='810.0' y='351.0' text-anchor='middle'>bar callbacks</text><rect class='node' x='120' y='230' width='240' height='64' fill='#f2ecff'/><text class='nodeLabel' x='240.0' y='267.0' text-anchor='middle'>Strategy / DataEngine</text><rect class='node' x='470' y='230' width='300' height='64' fill='#ecfff1'/><text class='nodeLabel' x='620.0' y='267.0' text-anchor='middle'>AngelOneDataClient _request_bars</text><rect class='node' x='900' y='230' width='230' height='64' fill='#fff7e6'/><text class='nodeLabel' x='1015.0' y='267.0' text-anchor='middle'>Angel Historical REST</text><rect class='node' x='900' y='420' width='230' height='64' fill='#fff0f0'/><text class='nodeLabel' x='1015.0' y='457.0' text-anchor='middle'>parse_bar row-by-row</text><rect class='node' x='1230' y='420' width='300' height='64' fill='#fff0f0'/><text class='nodeLabel' x='1380.0' y='457.0' text-anchor='middle'>_handle_data(Bar) to DataEngine</text></svg>