<svg xmlns="http://www.w3.org/2000/svg" width="1600" height="900" viewBox="0 0 1600 900"><defs><marker id='arrow' markerWidth='10' markerHeight='10' refX='9' refY='3' orient='auto' markerUnits='strokeWidth'><path d='M0,0 L10,3 L0,6 z' fill='#444'/></marker><style>text{font-family:Segoe UI,Arial,sans-serif; fill:#222; font-size:14px;}.title{font-size:26px; font-weight:700;}.edge{stroke:#444; stroke-width:2; fill:none; marker-end:url(#arrow);}.edgeLabel{font-size:12px; fill:#333;}.node{stroke:#2f2f2f; stroke-width:1.2; rx:10; ry:10;}.nodeLabel{font-size:13px; font-weight:600;}</style></defs><rect x='0' y='0' width='100%' height='100%' fill='#ffffff'/><text class='title' x='30' y='48'>Live Market Data Flow (Tick to Strategy)</text><line class='edge' x1='170.0' y1='252.0' x2='470.0' y2='252.0'/><text class='edgeLabel' x='320.0' y='246.0' text-anchor='middle'>tick</text><line class='edge' x1='470.0' y1='252.0' x2='805.0' y2='252.0'/><line class='edge' x1='805.0' y1='252.0' x2='1195.0' y2='252.0'/><text class='edgeLabel' x='1000.0' y='246.0' text-anchor='middle'>QuoteTick</text><line class='edge' x1='1195.0' y1='252.0' x2='1475.0' y2='252.0'/><line class='edge' x1='470.0' y1='252.0' x2='840.0' y2='452.0'/><text class='edgeLabel' x='655.0' y='346.0' text-anchor='middle'>_update_live_bar_subscriptions</text><line class='edge' x1='840.0' y1='452.0' x2='1185.0' y2='452.0'/><text class='edgeLabel' x='1012.5' y='446.0' text-anchor='middle'>Bar</text><line class='edge' x1='1185.0' y1='452.0' x2='1475.0' y2='252.0'/><rect class='node' x='60' y='220' width='220' height='64' fill='#fff7e6'/><text class='nodeLabel' x='170.0' y='257.0' text-anchor='middle'>Angel WebSocket Tick</text><rect class='node' x='360' y='220' width='220' height='64' fill='#ecfff1'/><text class='nodeLabel' x='470.0' y='257.0' text-anchor='middle'>AngelOneDataClient</text><rect class='node' x='660' y='220' width='290' height='64' fill='#ecfff1'/><text class='nodeLabel' x='805.0' y='257.0' text-anchor='middle'>parse_quote_tick + token resolve</text><rect class='node' x='1040' y='220' width='310' height='64' fill='#f2ecff'/><text class='nodeLabel' x='1195.0' y='257.0' text-anchor='middle'>DataEngine _handle_data(QuoteTick)</text><rect class='node' x='1390' y='220' width='170' height='64' fill='#f2ecff'/><text class='nodeLabel' x='1475.0' y='257.0' text-anchor='middle'>Strategy callbacks</text><rect class='node' x='700' y='420' width='280' height='64' fill='#fff0f0'/><text class='nodeLabel' x='840.0' y='457.0' text-anchor='middle'>Bar Aggregation (bucket close)</text><rect class='node' x='1040' y='420' width='290' height='64' fill='#fff0f0'/><text class='nodeLabel' x='1185.0' y='457.0' text-anchor='middle'>DataEngine _handle_data(Bar)</text></svg>